import os
import time
from playwright.sync_api import sync_playwright

html_content = "<div data-x-div-type=\"html\" ><div data-x-div-type=\"body\" > <div style='margin: 0 auto;border: 1px solid #e0e0e0;max-width: 700px;line-height: 20px;font-size: 13px;color: #222;font-family: Helvetica, \"Microsoft YaHei\", sans-serif'> <a href=\"https://www.nuonuo.com/nuonuo/web/aboutone/index/index.html\" target=\"_blank\" style=\"display: block;padding: 18px 4%;text-decoration: none\" tabindex=\"-1\" rel=\"external nofollow\"> <img style=\"width: 72;height: 21px;float: left\" src=\"https://inv.jss.com.cn/group3/M00/1A/13/wKj6y2NjfuaICa8uAAAcHL2uMVQAAE91AK4LakAABw0581.png\"> <span style=\"color: #666;font-size: 20px;line-height: 20px\"><span style=\"margin: 0 6px\">|</span><span style=\"font-size: 14px;position: relative;top: -2px\">&#20225;&#19994;&#25968;&#26234;&#21270;&#26381;&#21153;&#24179;&#21488;</span></span> <span style=\"float: right;color: #666;font-size: 12px\">&#20102;&#35299;&#35834;&#35834; &gt;</span> </a> <div> <div style=\"font-size: 16px;padding: 12px 4%;background: #F3F4F5;display: flex;justify-content: space-between\"> <div> <div style=\"color: #222;line-height: 32px;font-weight: 700\"> &#23562;&#25964;&#30340;&#23458;&#25143;,&#24744;&#30340;&#21457;&#31080;&#24050;&#32463;&#25104;&#21151;&#24320;&#20855;&#65281; </div> <div style=\"color: #999;line-height: 20px;font-size: 14px;margin-top: 6px\"> &#24744;&#20110;2025&#24180;7&#26376;20&#26085;&#28040;&#36153;&#24182;&#24320;&#20855;&#20102;&#25968;&#30005;&#26222;&#31080;(&#30005;&#23376;)&#65292;&#21457;&#31080;&#20449;&#24687;&#22914;&#19979; </div> </div> <a style=\"text-decoration: none;color: #fff;display: block;font-size: 13px;height: 32px;line-height: 32px;text-align: center;background-color: #007AFF;border-radius: 4px;width: 92px;margin-left: 90px;margin-top: 12px\" target=\"_blank\" href=\"https://nnfp.jss.com.cn/6FIDB_oO=Q-EmPi\" tabindex=\"-1\" rel=\"external nofollow\">&#19979;&#36733;&#21457;&#31080;</a> </div> <div style=\"margin: 0 0;border-radius: 4px;padding: 12px 4%;background: #fff\"> <div style=\"display: flex;align-items: flex-start\"> <div style=\"flex-grow: 1;margin-right: 10px;padding-top: 4px\"> <div style=\"display: flex;margin-bottom: 8px\"> <span style=\"flex-shrink: 0;color: #555\">&#21457;&#31080;&#25260;&#22836;&#65306;</span> <span style=\"font-weight: bold\">&#19978;&#28023;&#29956;&#27719;&#20449;&#24687;&#31185;&#25216;&#26377;&#38480;&#20844;&#21496;</span> </div> <div style=\"display: flex;margin-bottom: 8px\"> <span style=\"flex-shrink: 0;color: #555\">&#25968;&#30005;&#21495;&#30721;&#65306;</span> <span style=\"font-weight: bold\">25422000000132845197</span> </div> <div style=\"display: flex;margin-bottom: 8px\"> <span style=\"flex-shrink: 0;color: #555\">&#24320;&#31080;&#26085;&#26399;&#65306;</span> <span style=\"font-weight: bold\">2025&#24180;7&#26376;20&#26085;</span> </div> <div style=\"display: flex;margin-bottom: 8px\"> <span style=\"flex-shrink: 0;color: #555\">&#21512;&#35745;&#37329;&#39069;&#65306;</span> <span style=\"font-weight: bold\">&#65509;610.00</span> </div> </div> <div style=\"flex-shrink: 0;border-radius: 8px;padding: 0px 0 0px;background: #fff\"> <img style=\"margin: 0 25px;width: 90px;height: 90px\" src=\"https://nnfp.jss.com.cn/allow/service/getEwmImg.do?content=https://nnfp.jss.com.cn/6FIDB_oO=Q-EmPi\"> <div style=\"margin-top: 8px;text-align: center;font-size: 12px;position: relative;left: -6px\"> <img style=\"width: 12;height: 12px;margin-right: 8px;position: relative;top: 1px\" src=\"https://nnfw.jss.com.cn/nnwzfblogo.png\">&#25903;&#20184;&#23453; | &#25195;&#19968;&#25195;&#39046;&#21462;&#21457;&#31080; </div> </div> </div> <div style=\"display: flex;margin-bottom: 8px\"> <span style=\"flex-shrink: 0;color: #555\">&#28857;&#20987;&#38142;&#25509;&#26597;&#30475;&#21457;&#31080;&#65306;</span> <a style=\"text-decoration: underline;color: #007AFF;word-break: break-all\" target=\"_blank\" href=\"https://nnfp.jss.com.cn/6FIDB_oO=Q-EmPi\" tabindex=\"-1\" rel=\"external nofollow\">https://nnfp.jss.com.cn/6FIDB_oO=Q-EmPi</a> </div> </div> <div style=\"margin-bottom: 12px;padding: 12px 4%;background: #F3F4F5;font-size: 13px;color: #666\"> <div> <span>&#25552;&#31034;:</span> <span style=\"color: #FD6E0D\">&#22914;&#36935;&#21457;&#31080;&#24320;&#38169;&#38382;&#39064;&#65292;&#35831;&#33268;&#30005;&#28040;&#36153;&#21830;&#23478;&#12290;</span> <span>&#27492;&#30005;&#23376;&#21457;&#31080;&#30001;&#35834;&#35834;&#32593;&#20132;&#20184;&#65292;&#37038;&#20214;&#30001;&#31995;&#32479;&#33258;&#21160;&#21457;&#36865;&#65292;&#35831;&#21247;&#30452;&#25509;&#22238;&#22797;&#12290;</span> </div> <div> &#38144;&#26041;&#21517;&#31216;&#65306; <span style=\"color: #333\">&#27494;&#27721;&#24066;&#27494;&#26124;&#21306;&#26970;&#25991;&#35789;&#39184;&#39278;&#24215;</span> | &#38144;&#26041;&#30005;&#35805;&#65306; <span style=\"color: #333\">027-87276587</span> </div> </div> </div> <div> </div> <div style=\"display: flex;padding: 18px 40px 12px;font-size: 12px;color: #666;background: #F0F0F0\"> <div style=\"flex: 2.5;padding-left: 4%\"> <div style=\"display: flex;margin-bottom: 12px\"> <div style=\"margin-right: 50px\"> <div style=\"color: #666;margin-bottom: 8px\"> &#35834;&#35834;&#32593;&#21830;&#21153;&#21512;&#20316;&#30005;&#35805; </div> <div style=\"color: #222;font-size: 16px\"> 400-000-1551 </div> </div> <div> <div style=\"color: #666;margin-bottom: 8px\"> &#32852;&#31995;&#37038;&#31665; </div> <div style=\"color: #222;font-size: 16px\"> nnsw@nnuo.com </div> </div> </div> <div> <a href=\"https://fp.nuonuo.com/#/\" target=\"_blank\" style=\"padding: 6px 6px 6px 0;text-decoration: none;color: #343434;font-size: 12px\" tabindex=\"-1\" rel=\"external nofollow\">&#35834;&#35834;&#21457;&#31080;</a> | <a href=\"https://ntf.nuonuo.com/#/home\" target=\"_blank\" style=\"padding: 6px;text-decoration: none;color: #343434;font-size: 12px\" tabindex=\"-1\" rel=\"external nofollow\">&#35834;&#36890;&#20184;</a> | <a href=\"https://bmjc.nuonuo.com/Contents/smartCode/web/index.html#/index\" target=\"_blank\" style=\"padding: 6px;text-decoration: none;color: #343434;font-size: 12px\" tabindex=\"-1\" rel=\"external nofollow\">&#21830;&#21697;&#32534;&#30721;&#26816;&#27979;</a> | <a href=\"https://nst.nuonuo.com/#/\" target=\"_blank\" style=\"padding: 6px;text-decoration: none;color: #343434;font-size: 12px\" tabindex=\"-1\" rel=\"external nofollow\">&#35834;&#31246;&#36890;</a> | <a href=\"https://baoxiao.nuonuo.com/\" target=\"_blank\" style=\"padding: 6px;text-decoration: none;color: #343434;font-size: 12px\" tabindex=\"-1\" rel=\"external nofollow\">&#35834;&#35834;&#25253;&#38144;</a> </div> </div> <div style=\"flex: 1.2;padding-left: 4%\"> <div style=\"float: right\"> <img style=\"margin-bottom: 8px;width: 60px;height: 60px\" alt=\"\" src=\"https://nnfw.jss.com.cn/nnwwxicon.jpg\"> <div style=\"color: #343434;font-size: 12px\"> &#23448;&#26041;&#20844;&#20247;&#21495; </div> </div> </div> </div> </div> <img height=\"1\" width=\"1\" style=\"float: left\" src=\"http://linktrace.triggerdelivery.com/u/o1/N132-GI2DSMRS-GI2TANZSGAYTSMZWGQ2DGNJUGU3TCMA-JY-8D196E2A\"> </div></div>"

# 设置下载目录
download_dir = '~/Downloads'
if not os.path.exists(download_dir):
    os.makedirs(download_dir)

with sync_playwright() as p:
    browser = p.chromium.launch(headless=True)  # 有界面，方便调试
    context = browser.new_context(accept_downloads=Trdbue)
    page = context.new_page()

    # 打开页面
    page.goto('https://nnfp.jss.com.cn/6FIDB_oO=Q-EmPi')

    # 等待“下载PDF文件”按钮出现并点击
    try:
        # 等待按钮出现并可点击
        page.wait_for_selector("text=下载PDF文件", timeout=20000)
        with page.expect_download() as download_info:
            page.click("text=下载PDF文件")
        download = download_info.value
        # 保存下载的文件到指定目录
        save_path = os.path.join(download_dir, download.suggested_filename)
        download.save_as(save_path)
        print("PDF文件已下载：", save_path)
    except Exception as e:
        print("下载PDF文件失败，请检查页面或下载链接。", e)
    finally:
        browser.close()